(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4908],{3885:function(e,t,s){"use strict";s.r(t);let i={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"BotInfoForm_viewer",selections:[{alias:null,args:null,concreteType:"Bot",kind:"LinkedField",name:"availableBots",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"displayName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"model",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"allowsUserCreation",storageKey:null}],storageKey:null}],type:"Viewer",abstractKey:null};i.hash="7f43f61c7fe5c5909cb481d52e718bb5",t.default=i},84680:function(e,t,s){"use strict";s.d(t,{Z:function(){return V}});var i,a,l,n=s(85893),r=s(25675),o=s.n(r),c=s(41664),d=s.n(c),u=s(54977),m=s(67294),h=s(87536),v=s(22578),p=s(36876),x=s(75858),g=s(12278),f=s(57875),_=s(79652),j=s(90983),b=s.n(j);let w=(0,m.forwardRef)((e,t)=>(0,n.jsxs)("label",{className:b().switch,children:[(0,n.jsx)("input",{ref:t,className:b().input,type:"checkbox",...e}),(0,n.jsx)("span",{className:b().slider})]}));function N(){return(N=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e}).apply(this,arguments)}w.displayName="ToggleSwitch";var B=function(e){return m.createElement("svg",N({viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},e),i||(i=m.createElement("path",{d:"M7.5 20c-.12 0-.24-.02-.35-.06-.39-.15-.65-.52-.65-.94v-3h-1C3.57 16 2 14.43 2 12.5v-7C2 3.57 3.57 2 5.5 2h9C16.43 2 18 3.57 18 5.5v7c0 1.93-1.57 3.5-3.5 3.5h-3.05l-3.2 3.66c-.19.22-.47.34-.75.34Zm-2-16C4.67 4 4 4.67 4 5.5v7c0 .83.67 1.5 1.5 1.5h2c.55 0 1 .45 1 1v1.34l1.75-2A.98.98 0 0 1 11 14h3.5c.83 0 1.5-.67 1.5-1.5v-7c0-.83-.67-1.5-1.5-1.5h-9Z"})),a||(a=m.createElement("path",{d:"M6.75 10.25a1.25 1.25 0 1 0 0-2.5 1.25 1.25 0 0 0 0 2.5ZM10 10.25a1.25 1.25 0 1 0 0-2.5 1.25 1.25 0 0 0 0 2.5ZM13.25 10.25a1.25 1.25 0 1 0 0-2.5 1.25 1.25 0 0 0 0 2.5ZM20 12v6h-2c-.43 0-.79.27-.94.65l-.36-.36A.99.99 0 0 0 16 18H12.36l-.7.79c.31.71 1.02 1.21 1.84 1.21h2.09l1.71 1.71c.18.19.44.29.7.29.13 0 .26-.02.38-.08.38-.15.62-.52.62-.92v-1h1c1.1 0 2-.9 2-2v-4c0-1.1-.9-2-2-2Z"})))},I=s(57758);function y(){return(y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e}).apply(this,arguments)}var F=function(e){return m.createElement("svg",y({viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},e),l||(l=m.createElement("path",{d:"M19.88 3H4.12C2.95 3 2 3.95 2 5.12v10.42c0 1.17.95 2.12 2.12 2.12H11v1.83H8.06c-.55 0-1 .45-1 1s.45 1 1 1h7.7c.55 0 1-.45 1-1s-.45-1-1-1H13v-1.83h6.88c1.17 0 2.12-.95 2.12-2.12V5.12C22 3.95 21.05 3 19.88 3ZM20 15.54c0 .07-.06.12-.12.12H4.12c-.06.01-.12-.05-.12-.12V5.12c0-.06.06-.12.12-.12h15.75c.07 0 .13.06.13.12v10.42Z"})))},k=s(89569),S=s(4445),T=s(19),R=s.n(T),C=s(48430),P=s(8091);let A=e=>{let[t,s]=(0,m.useState)(void 0);return(0,m.useEffect)(()=>{if(e){let t=new FileReader;t.onload=e=>{var t;(null===(t=e.target)||void 0===t?void 0:t.result)&&s(e.target.result)},t.readAsDataURL(e)}else s(void 0)},[e]),t},E=e=>{let{children:t}=e;return(0,n.jsx)("div",{className:R().errorText,children:t})},Z=e=>{let{watch:t,defaultSrc:s}=e,i=t("image"),a=A(null==i?void 0:i[0]);return(0,n.jsx)(o(),{className:R().botImage,src:a||s||u.Z,alt:"Bot image",width:32,height:32})},M=e=>{let{watch:t,defaultProfilePictureSrc:s}=e,i=t("name"),a=t("introduction"),l=t("hasMarkdownRendering");return(0,n.jsxs)("div",{className:R().previewArea,children:[(0,n.jsxs)("div",{className:R().previewHeader,children:[(0,n.jsx)(Z,{defaultSrc:s,watch:t}),(0,n.jsx)("div",{className:R().previewTitle,children:i})]}),(0,n.jsxs)("div",{className:R().previewMessageArea,children:[(0,n.jsx)(p.OH,{}),a&&(0,n.jsx)(p.YD,{text:a,isBot:!0,isOptimistic:!1,timeoutLevel:0,state:P.Z.complete,allowImages:!1,improvedCodeblocks:!1,contentType:l?C.Z.text_markdown:C.Z.text_plain})]})]})};function L(e,t){return s=>new TextEncoder().encode(s).length<e||t}let D=e=>{let{register:t,profilePictureUrl:s,nameErrorMessage:i}=e;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(_.Z,{defaultSrc:s||u.Z,...t("image")}),(0,n.jsxs)("div",{className:R().section,children:[(0,n.jsx)("div",{className:R().sectionTitle,children:"Bot name"}),(0,n.jsx)("div",{className:R().subtext,children:"Bot name should be unique and 4-15 alphanumeric characters."}),(0,n.jsx)("input",{className:R().input,...t("name",{required:{value:!0,message:"Bot name is required."},maxLength:{value:15,message:"Bot name should be 15 or fewer characters."},minLength:{value:4,message:"Bot name should be 4 or more characters."},pattern:{value:/^[A-Za-z0-9]{4,15}$/,message:"Bot name can only include letters and numbers (no spaces)."}})}),i&&(0,n.jsx)(E,{children:i})]}),(0,n.jsxs)("div",{className:R().section,children:[(0,n.jsx)("div",{className:R().sectionTitle,children:"Bot description"}),(0,n.jsx)("input",{className:R().input,placeholder:"Optional",...t("description")})]})]})},O=e=>{let{startExpanded:t,register:s,watch:i}=e,[a,l]=(0,m.useState)(t),r=R().chevronDown;a&&(r+=" "+R().chevronDownExpanded);let o=(0,m.useCallback)(()=>{l(e=>!e)},[]),c=i("hasMarkdownRendering");return(0,n.jsxs)("div",{className:R().section,children:[(0,n.jsxs)("div",{className:R().sectionTitleWithIcon,onClick:o,children:[(0,n.jsx)("div",{className:R().sectionTitle,children:"Advanced"}),(0,n.jsx)(I.Z,{className:r})]}),(0,n.jsxs)("div",{"data-hidden":!a||void 0,className:R().toggleSection,children:[(0,n.jsxs)("div",{className:R().toggleRow,children:[(0,n.jsx)("div",{children:"Suggest replies"}),(0,n.jsx)(w,{...s("hasSuggestedReplies")})]}),(0,n.jsxs)("div",{className:R().toggleRow,children:[(0,n.jsx)("div",{children:"Render markdown content"}),(0,n.jsx)(w,{...s("hasMarkdownRendering")})]}),(0,n.jsxs)("div",{"data-hidden":!c||void 0,className:R().toggleRow,children:[(0,n.jsx)("div",{children:"Linkify bot responses"}),(0,n.jsx)(w,{...s("hasLinkification")})]})]})]})},q=e=>{let{text:t,isSelected:s,isApi:i,setShowApiFields:a,icon:l}=e,r=(0,m.useCallback)(()=>{a(i)},[i,a]);return(0,n.jsxs)("div",{className:"".concat(R().tabBarItem," ").concat(s?R().tabBarItemSelected:""),onClick:r,children:[l,(0,n.jsx)("div",{children:t})]})},H=e=>{let{showApiFields:t,setShowApiFields:s}=e;return(0,n.jsxs)("div",{className:R().tabBar,children:[(0,n.jsx)(q,{text:"Use prompt",isSelected:!t,isApi:!1,setShowApiFields:s,icon:(0,n.jsx)(B,{className:R().tabBarItemIcon})}),(0,n.jsx)(q,{text:"Use API",isSelected:t,isApi:!0,setShowApiFields:s,icon:(0,n.jsx)(F,{className:R().tabBarItemIcon})})]})},K=e=>{let{register:t,watch:s,availableBots:i,profilePictureUrl:a,promptErrorMessage:l,introErrorMessage:r,showApiFields:o,startAdvancedFieldsExpanded:c}=e;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:R().section,children:[(0,n.jsx)("div",{className:R().sectionTitle,children:"Base bot"}),(0,n.jsx)("select",{className:R().select,...t("baseBot",{validate:e=>!!o||!!e}),children:i.filter(e=>{let{allowsUserCreation:t}=e;return t}).map(e=>(0,n.jsx)("option",{value:e.model,children:e.displayName},e.model))})]}),(0,n.jsxs)("div",{className:R().section,children:[(0,n.jsx)("div",{className:R().sectionTitle,children:"Prompt"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:R().subtext,children:"All conversations with this bot will start with your prompt but it will not be visible to the user in the chat. If you would like the prompt message to be visible to the user, consider using an intro message instead."}),(0,n.jsx)(d(),{className:R().subtextLink,target:"_blank",href:"/prompt_examples",children:"View prompt examples"})]}),(0,n.jsxs)("div",{className:R().toggleRow,children:[(0,n.jsx)("div",{children:"Prompt visible from bot profile"}),(0,n.jsx)(w,{...t("promptIsPublic")})]}),(0,n.jsx)("textarea",{className:R().textarea,...t("prompt",{required:{value:!0,message:"Prompt is required"},maxLength:{value:2e3,message:"Prompt must be less than ".concat(2e3," characters.")},validate:L(2500,"Prompt must be less than 2500 bytes.")})}),l&&(0,n.jsx)(E,{children:l})]}),(0,n.jsxs)("div",{className:R().section,children:[(0,n.jsx)("div",{className:R().sectionTitle,children:"Intro message"}),(0,n.jsx)("div",{className:R().subtext,children:"The bot will send this message at the beginning of every conversation"}),(0,n.jsx)("input",{className:R().input,placeholder:"Optional",...t("introduction",{maxLength:{value:1e3,message:"Intro message must be less than ".concat(1e3," characters.")},validate:L(2500,"Intro message must be less than 2500 bytes.")})}),r&&(0,n.jsx)(E,{children:r})]}),(0,n.jsx)(O,{register:t,watch:s,startExpanded:c}),(0,n.jsxs)("div",{className:R().section,children:[(0,n.jsx)("div",{className:R().sectionTitle,children:"Bot preview"}),(0,n.jsx)(M,{defaultProfilePictureSrc:a,watch:s})]})]})},U=e=>{let{register:t,setValue:s,showApiFields:i,apiUrlErrorMessage:a}=e,l=(0,m.useCallback)(e=>{e.preventDefault(),s("apiKey",(0,k._)())},[s]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:R().section,children:[(0,n.jsx)("div",{className:R().sectionTitle,children:"API URL"}),(0,n.jsx)("input",{className:R().input,...t("apiUrl",{validate:e=>!!(!i||(0,S.jv)(e))||"Please enter a valid URL."})})]}),a&&(0,n.jsx)(E,{children:a}),(0,n.jsxs)("div",{className:R().section,children:[(0,n.jsx)("div",{className:R().sectionTitle,children:"API Key"}),(0,n.jsx)("input",{className:R().input,...t("apiKey")}),(0,n.jsx)(f.PL,{onClick:l,children:"Regenerate"})]}),(0,n.jsxs)("div",{className:R().section,children:[(0,n.jsx)("div",{className:R().sectionTitle,children:"Bot visibility"}),(0,n.jsx)("div",{children:(0,n.jsx)("div",{className:R().subtext,children:"If this setting is checked, the bot will be added to your profile and will be publicly visible. You can turn this off if you want to keep the bot private for testing purposes."})}),(0,n.jsxs)("div",{className:R().toggleRow,children:[(0,n.jsx)("div",{children:"Bot publicly visible"}),(0,n.jsx)(w,{...t("botIsPublic")})]})]})]})},z=e=>{var t,i,a,l;let{onSubmit:r,viewer:o,prompt:c,baseBot:d="a2",name:u,isPromptPublic:p=!0,introduction:f,description:_,profilePictureUrl:j,submitText:b,apiKey:w,apiUrl:N,isApiBot:B=!1,allowSwitchingBotType:I=!1,hasLinkification:y=!1,hasMarkdownRendering:F=!0,hasSuggestedReplies:k=!1,disclaimer:S,isPrivateBot:T,botVisibilityNote:C}=e,{availableBots:P}=(0,v.useFragment)(s(3885),o),{register:A,handleSubmit:E,watch:Z,formState:{errors:M},setValue:L}=(0,h.cI)({defaultValues:{name:u,description:_,baseBot:d,prompt:c,promptIsPublic:p,introduction:f,image:void 0,apiKey:w,apiUrl:N,isApiBot:B,hasLinkification:y,hasMarkdownRendering:F,hasSuggestedReplies:k,botIsPublic:!T},mode:"onBlur"}),O=(0,m.useMemo)(()=>y||!F||k,[]),[q,z]=(0,m.useState)(!1),[V,W]=(0,m.useState)(B),{shouldShowNux:Q}=(0,x.Bi)();return(0,n.jsxs)("form",{className:R().form,onSubmit:E(async e=>{if(!Q){e.isApiBot=V,V&&(e.baseBot=null!=d?d:"",e.promptIsPublic=null!=p&&p,e.introduction=null!=f?f:"",e.prompt=null!=c?c:""),z(!0);try{await r(e)}catch(e){throw z(!1),e}z(!1)}}),children:[(0,n.jsx)(D,{register:A,profilePictureUrl:j,nameErrorMessage:null===(t=M.name)||void 0===t?void 0:t.message}),I&&(0,n.jsx)(H,{showApiFields:V,setShowApiFields:W}),V?(0,n.jsx)(U,{register:A,setValue:L,showApiFields:V,apiUrlErrorMessage:null===(i=M.apiUrl)||void 0===i?void 0:i.message}):(0,n.jsx)(K,{register:A,watch:Z,availableBots:P,profilePictureUrl:j,promptErrorMessage:null===(a=M.prompt)||void 0===a?void 0:a.message,introErrorMessage:null===(l=M.introduction)||void 0===l?void 0:l.message,showApiFields:V,startAdvancedFieldsExpanded:O}),(0,n.jsxs)("div",{className:R().submitButtonSection,children:[(0,n.jsx)(g.Z,{type:"submit",disabled:q,variant:"primary",children:b}),(S||C)&&(0,n.jsxs)("div",{className:R().submitDisclaimer,children:[!V&&(null!=C?C:"")," ",null!=S?S:""]})]})]})};var V=z},28074:function(e,t,s){"use strict";var i=s(85893);s(67294);var a=s(68020),l=s.n(a),n=s(38004);let r=e=>{let{title:t}=e;return(0,i.jsx)(n.Z,{children:(0,i.jsx)("div",{className:l().title,children:t})})};t.Z=r},12278:function(e,t,s){"use strict";var i=s(85893),a=s(67294),l=s(57875),n=s(75858);let r=e=>{let{onClick:t,...s}=e,{shouldShowNux:r,openInitialNuxModal:o}=(0,n.Bi)(),c=(0,a.useCallback)(e=>r?o(s=>s&&(null==t?void 0:t(e))):null==t?void 0:t(e),[t,r,o]);return(0,i.jsx)(l.Xd,{onClick:c,...s})};t.Z=r},79652:function(e,t,s){"use strict";s.d(t,{Z:function(){return m}});var i=s(85893),a=s(25675),l=s.n(a),n=s(67294),r=s(19463),o=s.n(r),c=s(57875);let d=e=>{let{defaultSrc:t,onChangeRef:s,size:a=80,onClick:r}=e,[c,d]=(0,n.useState)(null);return s.current=(0,n.useCallback)(e=>{var t,s;if(null===(t=e.target)||void 0===t?void 0:null===(s=t.files)||void 0===s?void 0:s.length){let t=new FileReader;t.onload=e=>{var t;(null===(t=e.target)||void 0===t?void 0:t.result)&&d(e.target.result)},t.readAsDataURL(e.target.files[0])}else d(null)},[]),(0,i.jsx)(l(),{className:o().displayImage,src:c||t,alt:"Bot image",width:a,height:a,priority:!0,onClick:r})},u=(0,n.forwardRef)((e,t)=>{let{defaultSrc:s,size:a=80,onChange:l,...r}=e,u=(0,n.useRef)(null),m=(0,n.useCallback)(()=>{var e;null===(e=u.current)||void 0===e||e.click()},[]),h=(0,n.useRef)(null),v=(0,n.useCallback)(e=>{var t;null===(t=h.current)||void 0===t||t.call(h,e),null==l||l(e)},[l]),p=(0,n.useMemo)(()=>{var e;return e=[u,t],t=>{e.forEach(e=>{"function"==typeof e?e(t):null!=e&&(e.current=t)})}},[u,t]);return(0,i.jsxs)("div",{className:o().container,children:[(0,i.jsx)(d,{defaultSrc:s,onChangeRef:h,onClick:m,size:a}),(0,i.jsx)(c.t9,{className:o().editPictureButton,type:"button",onClick:m,children:"Edit picture"}),(0,i.jsx)("input",{...r,onChange:v,className:o().input,type:"file",accept:"image/*",multiple:!1,ref:p})]})});u.displayName="ImageSelector";var m=u},48951:function(e,t,s){"use strict";s.d(t,{I:function(){return a},W:function(){return l}});var i=s(41322);let a=async e=>{let t=new FormData;t.append("kind","qtext"),t.append("file",e),t.append("nid","0");let s=await fetch("/api/imgupload_POST",{method:"POST",body:t,headers:{"poe-formkey":(0,i.Mz)()},credentials:"include"});if(!s.ok)throw Error("Image upload failed: "+s.statusText);let a=await s.json();if(!a.success||!a.qimg_urls||!a.qimg_urls.length)throw Error("Image upload failed");return a.qimg_urls[0]},l=async e=>(null==e?void 0:e.length)?await a(e[0]):null},19:function(e){e.exports={form:"BotInfoForm_form__ssDjH",section:"BotInfoForm_section__evE42",toggleSection:"BotInfoForm_toggleSection__DpGZB",sectionTitle:"BotInfoForm_sectionTitle__tFzwk",subtext:"BotInfoForm_subtext__qVzVR",submitDisclaimer:"BotInfoForm_submitDisclaimer__enOP5",subtextLink:"BotInfoForm_subtextLink__qwssy",input:"BotInfoForm_input__gpcZm",select:"BotInfoForm_select__lFCl0",textarea:"BotInfoForm_textarea__u9o3a",toggleRow:"BotInfoForm_toggleRow__MKg8k",botImage:"BotInfoForm_botImage__pcY5n",previewArea:"BotInfoForm_previewArea__58ceA",previewHeader:"BotInfoForm_previewHeader__M_4N8",previewTitle:"BotInfoForm_previewTitle__jFlsA",previewMessageArea:"BotInfoForm_previewMessageArea__QcDRK",submitButtonSection:"BotInfoForm_submitButtonSection__Pnzqy",tabBar:"BotInfoForm_tabBar__6g8KP",tabBarItem:"BotInfoForm_tabBarItem__RWa6m",tabBarItemSelected:"BotInfoForm_tabBarItemSelected__jREo_",tabBarItemIcon:"BotInfoForm_tabBarItemIcon__ek0jt",errorText:"BotInfoForm_errorText__UxOOl",chevronDown:"BotInfoForm_chevronDown__LFWWC",chevronDownExpanded:"BotInfoForm_chevronDownExpanded__rpNJH",sectionTitleWithIcon:"BotInfoForm_sectionTitleWithIcon__NLLuD"}},68020:function(e){e.exports={title:"BasicNavbar_title__zmQ_t"}},19463:function(e){e.exports={container:"ImageSelector_container__JQqDo",displayImage:"ImageSelector_displayImage__KixND",editPictureButton:"ImageSelector_editPictureButton__ef_Ly",input:"ImageSelector_input__NNS7F"}},90983:function(e){e.exports={switch:"ToggleSwitch_switch__zCK_g",slider:"ToggleSwitch_slider__dcLHT"}}}]);